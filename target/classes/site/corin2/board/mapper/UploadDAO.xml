<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

	<mapper namespace="site.corin2.board.dao.UploadDAO">

<!-- 		<select id="boardAllSelect" resultType="site.corin2.board.dto.BoardDTO">
				select * from board b join announce a on a.boardnum = b.boardnum
				where b.SKILLNUM ='s100' and b.isdeleted = 0  
		</select>

		<select id="boardSelect" resultType="site.corin2.board.dto.BoardDTO">
			select * from board b join announce a on a.boardnum = b.boardnum
			where b.boardnum = #{boardNum} and b.isdeleted = 0
		
		</select>
		 -->

		<insert id="boardInsert" parameterType="site.corin2.board.dto.BoardDTO">
			insert into board(skillnum , userid, boarddate,isdeleted) 
			values('S700',#{userId},now(),0)
			
		</insert>
	
				
		<insert id="uploadInsert" parameterType="site.corin2.board.dto.UploadDTO">
			<selectKey order="BEFORE" keyProperty="boardNum" resultType="int">
				select IFNULL(max(boardnum), 0) from board where skillnum ='S700'
			</selectKey>
			insert into upload(boardnum , skillnum , projectnum , uploadalias ,uploadorigin) 
			values(#{boardNum},'S700',#{projectNum},#{uploadAlias},#{uploadOrigin})
		</insert>
		
		<select id="uploadSelect" resultType="site.corin2.board.dto.UploadDTO">
		select m.username,m.userprofile ,u.uploadorigin  from board b ,upload u,user m
		WHERE b.boardnum = u.boardnum and b.userid= m.userid     
		and b.SKILLNUM ='S700' and b.isdeleted = 0 and u.projectnum =  #{projectNum}
		</select>
	
	
		
	</mapper>